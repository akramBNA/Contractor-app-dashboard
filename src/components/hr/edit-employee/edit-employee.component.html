<h1 class="text-3xl font-bold text-gray-800 mb-8 text-center">Modifier un Employé</h1>

<app-loading-spinner *ngIf="isLoading"></app-loading-spinner>

<form *ngIf="employeeForm" [formGroup]="employeeForm" class="space-y-12 px-6 md:px-12">
  <div>
    <h2 class="text-xl font-semibold text-gray-700 mb-6 border-b pb-2">Informations Générales</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <mat-form-field appearance="fill">
        <mat-label>Prénom</mat-label>
        <input matInput formControlName="employee_name" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Nom</mat-label>
        <input matInput formControlName="employee_lastname" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>N° de Téléphone</mat-label>
        <input matInput formControlName="employee_phone_number" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Email</mat-label>
        <input matInput type="email" formControlName="employee_email" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Adresse</mat-label>
        <input matInput formControlName="employee_address" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>CIN</mat-label>
        <input matInput formControlName="employee_national_id" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Sexe</mat-label>
        <mat-select formControlName="employee_gender">
          <mat-option value="">-- Sélectionner --</mat-option>
          <mat-option value="Male">Homme</mat-option>
          <mat-option value="Female">Femme</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Date de Naissance</mat-label>
        <input matInput [matDatepicker]="birthPicker" formControlName="employee_birth_date" />
        <mat-datepicker-toggle matSuffix [for]="birthPicker"></mat-datepicker-toggle>
        <mat-datepicker #birthPicker></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Titre d'Emploi</mat-label>
        <mat-select formControlName="employee_job_title">
          <mat-option value="">-- Sélectionner --</mat-option>
          <mat-option *ngFor="let jobs of jobs_data" [value]="jobs.job_name">{{ jobs.job_name }}</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Matricule</mat-label>
        <input matInput formControlName="employee_matricule" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Date de Début</mat-label>
        <input matInput [matDatepicker]="startPicker" formControlName="employee_joining_date" />
        <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
        <mat-datepicker #startPicker></mat-datepicker>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Date de la Fin</mat-label>
        <input matInput [matDatepicker]="endPicker" formControlName="employee_end_date" [placeholder]="employeeForm.get('employee_end_date')?.value ? '' : 'Active Employee'" />
        <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
        <mat-datepicker #endPicker></mat-datepicker>
      </mat-form-field>
    </div>
  </div>
</form>

<form *ngIf="contactForm" [formGroup]="contactForm" class="space-y-12 px-6 md:px-12 mt-12">
  <div>
    <h2 class="text-xl font-semibold text-gray-700 mb-6 border-b pb-2">Informations du Contrat</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <mat-form-field appearance="fill">
        <mat-label>Type du Contrat</mat-label>
        <mat-select formControlName="contract_type_id">
          <mat-option value="">-- Sélectionner --</mat-option>
          <mat-option *ngFor="let contract of contract_types_data" [value]="contract.contract_type_id">
            {{ contract.contract_name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Salaire</mat-label>
        <input matInput type="number" formControlName="salary" />
      </mat-form-field>
    </div>
  </div>
</form>

<form [formGroup]="bankDetailsForm" class="space-y-12 px-6 md:px-12 mt-12">
  <div>
    <h2 class="text-xl font-semibold text-gray-700 mb-6 border-b pb-2">Informations Bancaires</h2>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <mat-form-field appearance="fill">
        <mat-label>Nom & Prénom</mat-label>
        <input matInput formControlName="account_holder_name" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>N° de Compte</mat-label>
        <input matInput formControlName="account_number" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Banque</mat-label>
        <mat-select formControlName="bank_name">
          <mat-option value="">-- Sélectionner --</mat-option>
          <mat-option *ngFor="let bank of [
            'BNA','BH','BIAT','AMEN','BT','ATB','BTS','UIB','TSB','ABC','BFT','UBCI','STB','ZITOUNA','BTK','ATTIJARI','BTL','ALBARAKA','BTE','CITI','QNB','BFPME','ALWIFAK','La POSTE']"
            [value]="bank">
            {{ bank }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Branche</mat-label>
        <input matInput formControlName="branch_location" />
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Identificateur Fiscale</mat-label>
        <input matInput formControlName="tax_payer_id" />
      </mat-form-field>
    </div>
  </div>
</form>

<div class="flex flex-col sm:flex-row items-center justify-center gap-4 pt-6">
  <button class="btn-edit" (click)="UpdateEmployee()">Modifier</button>
  <button class="btn-cancel" (click)="onCancel()">Annuler</button>
</div>
