<h1 class="text-3xl font-bold text-gray-800 mb-8 text-center">Demande Congés</h1>

<app-loading-spinner *ngIf="isLoading"></app-loading-spinner>

<h2 class="text-xl font-semibold text-gray-700 mb-6 border-b pb-2">Demande Congé</h2>

<div class="flex flex-col md:flex-row gap-6">
  <div class="flex-1">
    <form [formGroup]="requestLeavesForm">

      <div class="space-y-6">
        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Raison du congé</mat-label>
          <input matInput formControlName="description" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Type du congé</mat-label>
          <mat-select formControlName="leave_type_id">
            <mat-option value="">-- Sélectionner --</mat-option>
            <mat-option *ngFor="let lt of leave_types_data" [value]="lt.leave_type_id">
              {{ translateLeaveType(lt.leave_type_name) }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Date de Début</mat-label>
          <input matInput [matDatepicker]="startPicker" formControlName="start_date" />
          <mat-datepicker-toggle matSuffix [for]="startPicker"></mat-datepicker-toggle>
          <mat-datepicker #startPicker></mat-datepicker>
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Date de Fin</mat-label>
          <input matInput [matDatepicker]="endPicker" formControlName="end_date" [min]="minEndDate" />
          <mat-datepicker-toggle matSuffix [for]="endPicker"></mat-datepicker-toggle>
          <mat-datepicker #endPicker></mat-datepicker>
        </mat-form-field>
      </div>

      <div class="text-center pt-6">
        <button type="button" (click)="requestLeave()" class="btn-add">Demander un congé</button>
      </div>
    </form>
  </div>

  <div class="w-full md:w-1/3 flex flex-col items-center justify-center">
    <canvas id="leaveDonutChart" class="w-60 h-60"></canvas>
    <p class="mt-4 text-gray-600 font-medium">
      {{ leave_balance }} / 30 jours utilisés
    </p>
  </div>
</div>